(function(){"use strict";/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const H=Symbol("Comlink.proxy"),K=Symbol("Comlink.endpoint"),Q=Symbol("Comlink.releaseProxy"),q=Symbol("Comlink.finalizer"),M=Symbol("Comlink.thrown"),F=e=>typeof e=="object"&&e!==null||typeof e=="function",Z={canHandle:e=>F(e)&&e[H],serialize(e){const{port1:t,port2:r}=new MessageChannel;return U(e,t),[r,[r]]},deserialize(e){return e.start(),nt(e)}},tt={canHandle:e=>F(e)&&M in e,serialize({value:e}){let t;return e instanceof Error?t={isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:t={isError:!1,value:e},[t,[]]},deserialize(e){throw e.isError?Object.assign(new Error(e.value.message),e.value):e.value}},V=new Map([["proxy",Z],["throw",tt]]);function et(e,t){for(const r of e)if(t===r||r==="*"||r instanceof RegExp&&r.test(t))return!0;return!1}function U(e,t=globalThis,r=["*"]){t.addEventListener("message",function s(o){if(!o||!o.data)return;if(!et(r,o.origin)){console.warn(`Invalid origin '${o.origin}' for comlink proxy`);return}const{id:_,type:a,path:i}=Object.assign({path:[]},o.data),c=(o.data.argumentList||[]).map(d);let u;try{const f=i.slice(0,-1).reduce((l,A)=>l[A],e),p=i.reduce((l,A)=>l[A],e);switch(a){case"GET":u=p;break;case"SET":f[i.slice(-1)[0]]=d(o.data.value),u=!0;break;case"APPLY":u=p.apply(f,c);break;case"CONSTRUCT":{const l=new p(...c);u=ct(l)}break;case"ENDPOINT":{const{port1:l,port2:A}=new MessageChannel;U(e,A),u=it(l,[l])}break;case"RELEASE":u=void 0;break;default:return}}catch(f){u={value:f,[M]:0}}Promise.resolve(u).catch(f=>({value:f,[M]:0})).then(f=>{const[p,l]=R(f);t.postMessage(Object.assign(Object.assign({},p),{id:_}),l),a==="RELEASE"&&(t.removeEventListener("message",s),D(t),q in e&&typeof e[q]=="function"&&e[q]())}).catch(f=>{const[p,l]=R({value:new TypeError("Unserializable return value"),[M]:0});t.postMessage(Object.assign(Object.assign({},p),{id:_}),l)})}),t.start&&t.start()}function rt(e){return e.constructor.name==="MessagePort"}function D(e){rt(e)&&e.close()}function nt(e,t){return z(e,[],t)}function j(e){if(e)throw new Error("Proxy has been released and is not useable")}function B(e){return w(e,{type:"RELEASE"}).then(()=>{D(e)})}const S=new WeakMap,O="FinalizationRegistry"in globalThis&&new FinalizationRegistry(e=>{const t=(S.get(e)||0)-1;S.set(e,t),t===0&&B(e)});function st(e,t){const r=(S.get(t)||0)+1;S.set(t,r),O&&O.register(e,t,e)}function ot(e){O&&O.unregister(e)}function z(e,t=[],r=function(){}){let s=!1;const o=new Proxy(r,{get(_,a){if(j(s),a===Q)return()=>{ot(o),B(e),s=!0};if(a==="then"){if(t.length===0)return{then:()=>o};const i=w(e,{type:"GET",path:t.map(c=>c.toString())}).then(d);return i.then.bind(i)}return z(e,[...t,a])},set(_,a,i){j(s);const[c,u]=R(i);return w(e,{type:"SET",path:[...t,a].map(f=>f.toString()),value:c},u).then(d)},apply(_,a,i){j(s);const c=t[t.length-1];if(c===K)return w(e,{type:"ENDPOINT"}).then(d);if(c==="bind")return z(e,t.slice(0,-1));const[u,f]=G(i);return w(e,{type:"APPLY",path:t.map(p=>p.toString()),argumentList:u},f).then(d)},construct(_,a){j(s);const[i,c]=G(a);return w(e,{type:"CONSTRUCT",path:t.map(u=>u.toString()),argumentList:i},c).then(d)}});return st(o,e),o}function at(e){return Array.prototype.concat.apply([],e)}function G(e){const t=e.map(R);return[t.map(r=>r[0]),at(t.map(r=>r[1]))]}const Y=new WeakMap;function it(e,t){return Y.set(e,t),e}function ct(e){return Object.assign(e,{[H]:!0})}function R(e){for(const[t,r]of V)if(r.canHandle(e)){const[s,o]=r.serialize(e);return[{type:"HANDLER",name:t,value:s},o]}return[{type:"RAW",value:e},Y.get(e)||[]]}function d(e){switch(e.type){case"HANDLER":return V.get(e.name).deserialize(e.value);case"RAW":return e.value}}function w(e,t,r){return new Promise(s=>{const o=_t();e.addEventListener("message",function _(a){!a.data||!a.data.id||a.data.id!==o||(e.removeEventListener("message",_),s(a.data))}),e.start&&e.start(),e.postMessage(Object.assign({id:o},t),r)})}function _t(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}let n;const g=new Array(128).fill(void 0);g.push(void 0,null,!0,!1);function x(e){return g[e]}let y=g.length;function ut(e){e<132||(g[e]=y,y=e)}function $(e){const t=x(e);return ut(e),t}const X=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});X.decode();let k=null;function T(){return(k===null||k.byteLength===0)&&(k=new Uint8Array(n.memory.buffer)),k}function L(e,t){return X.decode(T().subarray(e,e+t))}function C(e){y===g.length&&g.push(g.length+1);const t=y;return y=g[t],g[t]=e,t}let E=0;const P=new TextEncoder("utf-8"),ft=typeof P.encodeInto=="function"?function(e,t){return P.encodeInto(e,t)}:function(e,t){const r=P.encode(e);return t.set(r),{read:e.length,written:r.length}};function N(e,t,r){if(r===void 0){const i=P.encode(e),c=t(i.length);return T().subarray(c,c+i.length).set(i),E=i.length,c}let s=e.length,o=t(s);const _=T();let a=0;for(;a<s;a++){const i=e.charCodeAt(a);if(i>127)break;_[o+a]=i}if(a!==s){a!==0&&(e=e.slice(a)),o=r(o,s,s=a+e.length*3);const i=T().subarray(o+a,o+s),c=ft(e,i);a+=c.written}return E=a,o}let v=null;function h(){return(v===null||v.byteLength===0)&&(v=new Int32Array(n.memory.buffer)),v}function W(e,t){if(!(e instanceof t))throw new Error(`expected instance of ${t.name}`);return e.ptr}class b{static __wrap(t){const r=Object.create(b.prototype);return r.ptr=t,r}__destroy_into_raw(){const t=this.ptr;return this.ptr=0,t}free(){const t=this.__destroy_into_raw();n.__wbg_board_free(t)}constructor(){const t=n.board_new();return b.__wrap(t)}static from_json(t){const r=N(t,n.__wbindgen_malloc,n.__wbindgen_realloc),s=E,o=n.board_from_json(r,s);return b.__wrap(o)}to_json(){try{const s=n.__wbindgen_add_to_stack_pointer(-16);n.board_to_json(s,this.ptr);var t=h()[s/4+0],r=h()[s/4+1];return L(t,r)}finally{n.__wbindgen_add_to_stack_pointer(16),n.__wbindgen_free(t,r)}}init_default_state(){n.board_init_default_state(this.ptr)}get_bitboard(t,r){const s=n.board_get_bitboard(this.ptr,t,r);return BigInt.asUintN(64,s)}has_piece(t,r){return n.board_has_piece(this.ptr,t,r)!==0}is_king(t,r){return n.board_is_king(this.ptr,t,r)!==0}get_piece(t){const r=n.board_get_piece(this.ptr,t);return I.__wrap(r)}get_pieces(){const t=n.board_get_pieces(this.ptr);return $(t)}update_from_move(t){W(t,m),n.board_update_from_move(this.ptr,t.ptr)}is_game_over(){return n.board_is_game_over(this.ptr)!==0}}class lt{__destroy_into_raw(){const t=this.ptr;return this.ptr=0,t}free(){const t=this.__destroy_into_raw();n.__wbg_checkersai_free(t)}static get_heuristic_value(t){return W(t,b),n.checkersai_get_heuristic_value(t.ptr)}static alphabeta(t,r,s,o,_){return W(t,b),n.checkersai_alphabeta(t.ptr,r,s,o,_)}static get_best_move_alphabeta(t,r,s){W(t,b);const o=n.checkersai_get_best_move_alphabeta(t.ptr,r,s);return m.__wrap(o)}}class m{static __wrap(t){const r=Object.create(m.prototype);return r.ptr=t,r}__destroy_into_raw(){const t=this.ptr;return this.ptr=0,t}free(){const t=this.__destroy_into_raw();n.__wbg_move_free(t)}get start_square(){return n.__wbg_get_move_start_square(this.ptr)}set start_square(t){n.__wbg_set_move_start_square(this.ptr,t)}get end_square(){return n.__wbg_get_move_end_square(this.ptr)}set end_square(t){n.__wbg_set_move_end_square(this.ptr,t)}get capture_square(){return n.__wbg_get_move_capture_square(this.ptr)}set capture_square(t){n.__wbg_set_move_capture_square(this.ptr,t)}get did_capture(){return n.__wbg_get_move_did_capture(this.ptr)!==0}set did_capture(t){n.__wbg_set_move_did_capture(this.ptr,t)}get can_capture_again(){return n.__wbg_get_move_can_capture_again(this.ptr)!==0}set can_capture_again(t){n.__wbg_set_move_can_capture_again(this.ptr,t)}get did_king(){return n.__wbg_get_move_did_king(this.ptr)!==0}set did_king(t){n.__wbg_set_move_did_king(this.ptr,t)}static from_json(t){const r=N(t,n.__wbindgen_malloc,n.__wbindgen_realloc),s=E,o=n.move_from_json(r,s);return m.__wrap(o)}to_json(){try{const s=n.__wbindgen_add_to_stack_pointer(-16);n.move_to_json(s,this.ptr);var t=h()[s/4+0],r=h()[s/4+1];return L(t,r)}finally{n.__wbindgen_add_to_stack_pointer(16),n.__wbindgen_free(t,r)}}}class I{static __wrap(t){const r=Object.create(I.prototype);return r.ptr=t,r}__destroy_into_raw(){const t=this.ptr;return this.ptr=0,t}free(){const t=this.__destroy_into_raw();n.__wbg_piece_free(t)}get color(){return n.__wbg_get_piece_color(this.ptr)>>>0}set color(t){n.__wbg_set_piece_color(this.ptr,t)}get is_king(){return n.__wbg_get_piece_is_king(this.ptr)!==0}set is_king(t){n.__wbg_set_piece_is_king(this.ptr,t)}}async function gt(e,t){if(typeof Response=="function"&&e instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(e,t)}catch(s){if(e.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",s);else throw s}const r=await e.arrayBuffer();return await WebAssembly.instantiate(r,t)}else{const r=await WebAssembly.instantiate(e,t);return r instanceof WebAssembly.Instance?{instance:r,module:e}:r}}function pt(){const e={};return e.wbg={},e.wbg.__wbg_move_new=function(t){const r=m.__wrap(t);return C(r)},e.wbg.__wbg_piece_new=function(t){const r=I.__wrap(t);return C(r)},e.wbg.__wbindgen_object_drop_ref=function(t){$(t)},e.wbg.__wbg_new_abda76e883ba8a5f=function(){const t=new Error;return C(t)},e.wbg.__wbg_stack_658279fe44541cf6=function(t,r){const s=x(r).stack,o=N(s,n.__wbindgen_malloc,n.__wbindgen_realloc),_=E;h()[t/4+1]=_,h()[t/4+0]=o},e.wbg.__wbg_error_f851667af71bcfc6=function(t,r){try{console.error(L(t,r))}finally{n.__wbindgen_free(t,r)}},e.wbg.__wbg_new_b525de17f44a8943=function(){const t=new Array;return C(t)},e.wbg.__wbg_push_49c286f04dd3bf59=function(t,r){return x(t).push(x(r))},e.wbg.__wbindgen_throw=function(t,r){throw new Error(L(t,r))},e}function bt(e,t){return n=e.exports,J.__wbindgen_wasm_module=t,v=null,k=null,n.__wbindgen_start(),n}async function J(e){typeof e>"u"&&(e=new URL(""+new URL("wasm_checkers_bg-96dcdac9.wasm",document.currentScript&&document.currentScript.src||document.baseURI).href,self.location));const t=pt();(typeof e=="string"||typeof Request=="function"&&e instanceof Request||typeof URL=="function"&&e instanceof URL)&&(e=fetch(e));const{instance:r,module:s}=await gt(await e,t);return bt(r,s)}var dt=Object.freeze({__proto__:null,getBestMove:async(e,t,r)=>{const s=b.from_json(e);return lt.get_best_move_alphabeta(s,t,r).to_json()},initWasm:async()=>{await J("wasm_checkers_bg-fe9b7745.wasm")}});U(dt)})();
