(function(){"use strict";/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const B=Symbol("Comlink.proxy"),te=Symbol("Comlink.endpoint"),ne=Symbol("Comlink.releaseProxy"),F=Symbol("Comlink.finalizer"),C=Symbol("Comlink.thrown"),G=t=>typeof t=="object"&&t!==null||typeof t=="function",re={canHandle:t=>G(t)&&t[B],serialize(t){const{port1:e,port2:n}=new MessageChannel;return q(t,e),[n,[n]]},deserialize(t){return t.start(),ce(t)}},oe={canHandle:t=>G(t)&&C in t,serialize({value:t}){let e;return t instanceof Error?e={isError:!0,value:{message:t.message,name:t.name,stack:t.stack}}:e={isError:!1,value:t},[e,[]]},deserialize(t){throw t.isError?Object.assign(new Error(t.value.message),t.value):t.value}},Y=new Map([["proxy",re],["throw",oe]]);function se(t,e){for(const n of t)if(e===n||n==="*"||n instanceof RegExp&&n.test(e))return!0;return!1}function q(t,e=globalThis,n=["*"]){e.addEventListener("message",function r(s){if(!s||!s.data)return;if(!se(n,s.origin)){console.warn(`Invalid origin '${s.origin}' for comlink proxy`);return}const{id:_,type:i,path:a}=Object.assign({path:[]},s.data),f=(s.data.argumentList||[]).map(h);let b;try{const g=a.slice(0,-1).reduce((l,T)=>l[T],t),m=a.reduce((l,T)=>l[T],t);switch(i){case"GET":b=m;break;case"SET":g[a.slice(-1)[0]]=h(s.data.value),b=!0;break;case"APPLY":b=m.apply(g,f);break;case"CONSTRUCT":{const l=new m(...f);b=be(l)}break;case"ENDPOINT":{const{port1:l,port2:T}=new MessageChannel;q(t,T),b=fe(l,[l])}break;case"RELEASE":b=void 0;break;default:return}}catch(g){b={value:g,[C]:0}}Promise.resolve(b).catch(g=>({value:g,[C]:0})).then(g=>{const[m,l]=U(g);e.postMessage(Object.assign(Object.assign({},m),{id:_}),l),i==="RELEASE"&&(e.removeEventListener("message",r),J(e),F in t&&typeof t[F]=="function"&&t[F]())}).catch(g=>{const[m,l]=U({value:new TypeError("Unserializable return value"),[C]:0});e.postMessage(Object.assign(Object.assign({},m),{id:_}),l)})}),e.start&&e.start()}function ie(t){return t.constructor.name==="MessagePort"}function J(t){ie(t)&&t.close()}function ce(t,e){return H(t,[],e)}function P(t){if(t)throw new Error("Proxy has been released and is not useable")}function X(t){return k(t,{type:"RELEASE"}).then(()=>{J(t)})}const W=new WeakMap,I="FinalizationRegistry"in globalThis&&new FinalizationRegistry(t=>{const e=(W.get(t)||0)-1;W.set(t,e),e===0&&X(t)});function _e(t,e){const n=(W.get(e)||0)+1;W.set(e,n),I&&I.register(t,e,t)}function ae(t){I&&I.unregister(t)}function H(t,e=[],n=function(){}){let r=!1;const s=new Proxy(n,{get(_,i){if(P(r),i===ne)return()=>{ae(s),X(t),r=!0};if(i==="then"){if(e.length===0)return{then:()=>s};const a=k(t,{type:"GET",path:e.map(f=>f.toString())}).then(h);return a.then.bind(a)}return H(t,[...e,i])},set(_,i,a){P(r);const[f,b]=U(a);return k(t,{type:"SET",path:[...e,i].map(g=>g.toString()),value:f},b).then(h)},apply(_,i,a){P(r);const f=e[e.length-1];if(f===te)return k(t,{type:"ENDPOINT"}).then(h);if(f==="bind")return H(t,e.slice(0,-1));const[b,g]=K(a);return k(t,{type:"APPLY",path:e.map(m=>m.toString()),argumentList:b},g).then(h)},construct(_,i){P(r);const[a,f]=K(i);return k(t,{type:"CONSTRUCT",path:e.map(b=>b.toString()),argumentList:a},f).then(h)}});return _e(s,t),s}function ue(t){return Array.prototype.concat.apply([],t)}function K(t){const e=t.map(U);return[e.map(n=>n[0]),ue(e.map(n=>n[1]))]}const Q=new WeakMap;function fe(t,e){return Q.set(t,e),t}function be(t){return Object.assign(t,{[B]:!0})}function U(t){for(const[e,n]of Y)if(n.canHandle(t)){const[r,s]=n.serialize(t);return[{type:"HANDLER",name:e,value:r},s]}return[{type:"RAW",value:t},Q.get(t)||[]]}function h(t){switch(t.type){case"HANDLER":return Y.get(t.name).deserialize(t.value);case"RAW":return t.value}}function k(t,e,n){return new Promise(r=>{const s=ge();t.addEventListener("message",function _(i){!i.data||!i.data.id||i.data.id!==s||(t.removeEventListener("message",_),r(i.data))}),t.start&&t.start(),t.postMessage(Object.assign({id:s},e),n)})}function ge(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}let o;const d=new Array(128).fill(void 0);d.push(void 0,null,!0,!1);function c(t){return d[t]}let v=d.length;function le(t){t<132||(d[t]=v,v=t)}function $(t){const e=c(t);return le(t),e}const Z=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});Z.decode();let S=null;function N(){return(S===null||S.byteLength===0)&&(S=new Uint8Array(o.memory.buffer)),S}function O(t,e){return Z.decode(N().subarray(t,t+e))}function u(t){v===d.length&&d.push(d.length+1);const e=v;return v=d[e],d[e]=t,e}let E=0;const z=new TextEncoder("utf-8"),we=typeof z.encodeInto=="function"?function(t,e){return z.encodeInto(t,e)}:function(t,e){const n=z.encode(t);return e.set(n),{read:t.length,written:n.length}};function x(t,e,n){if(n===void 0){const a=z.encode(t),f=e(a.length);return N().subarray(f,f+a.length).set(a),E=a.length,f}let r=t.length,s=e(r);const _=N();let i=0;for(;i<r;i++){const a=t.charCodeAt(i);if(a>127)break;_[s+i]=a}if(i!==r){i!==0&&(t=t.slice(i)),s=n(s,r,r=i+t.length*3);const a=N().subarray(s+i,s+r),f=we(t,a);i+=f.written}return E=i,s}function M(t){return t==null}let R=null;function w(){return(R===null||R.byteLength===0)&&(R=new Int32Array(o.memory.buffer)),R}let L=null;function de(){return(L===null||L.byteLength===0)&&(L=new Float64Array(o.memory.buffer)),L}function D(t){const e=typeof t;if(e=="number"||e=="boolean"||t==null)return`${t}`;if(e=="string")return`"${t}"`;if(e=="symbol"){const s=t.description;return s==null?"Symbol":`Symbol(${s})`}if(e=="function"){const s=t.name;return typeof s=="string"&&s.length>0?`Function(${s})`:"Function"}if(Array.isArray(t)){const s=t.length;let _="[";s>0&&(_+=D(t[0]));for(let i=1;i<s;i++)_+=", "+D(t[i]);return _+="]",_}const n=/\[object ([^\]]+)\]/.exec(toString.call(t));let r;if(n.length>1)r=n[1];else return toString.call(t);if(r=="Object")try{return"Object("+JSON.stringify(t)+")"}catch{return"Object"}return t instanceof Error?`${t.name}: ${t.message}
${t.stack}`:r}function j(t,e){if(!(t instanceof e))throw new Error(`expected instance of ${e.name}`);return t.ptr}function V(t,e){try{return t.apply(this,e)}catch(n){o.__wbindgen_exn_store(u(n))}}class A{static __wrap(e){const n=Object.create(A.prototype);return n.ptr=e,n}__destroy_into_raw(){const e=this.ptr;return this.ptr=0,e}free(){const e=this.__destroy_into_raw();o.__wbg_board_free(e)}constructor(){const e=o.board_new();return A.__wrap(e)}static from_json(e){const n=x(e,o.__wbindgen_malloc,o.__wbindgen_realloc),r=E,s=o.board_from_json(n,r);return A.__wrap(s)}to_json(){try{const r=o.__wbindgen_add_to_stack_pointer(-16);o.board_to_json(r,this.ptr);var e=w()[r/4+0],n=w()[r/4+1];return O(e,n)}finally{o.__wbindgen_add_to_stack_pointer(16),o.__wbindgen_free(e,n)}}init_default_state(){o.board_init_default_state(this.ptr)}get_pieces(){const e=o.board_get_pieces(this.ptr);return $(e)}handle_move(e){j(e,y),o.board_handle_move(this.ptr,e.ptr)}is_game_over(e){return o.board_is_game_over(this.ptr,e)!==0}}class pe{__destroy_into_raw(){const e=this.ptr;return this.ptr=0,e}free(){const e=this.__destroy_into_raw();o.__wbg_checkersai_free(e)}static get_heuristic_value_js(e,n){return j(e,A),o.checkersai_get_heuristic_value_js(e.ptr,n)}static get_best_move_alphabeta(e,n,r,s,_){j(e,A);let i=0;M(_)||(j(_,y),i=_.__destroy_into_raw());const a=o.checkersai_get_best_move_alphabeta(e.ptr,n,r,s,i);return a===0?void 0:y.__wrap(a)}}class y{static __wrap(e){const n=Object.create(y.prototype);return n.ptr=e,n}__destroy_into_raw(){const e=this.ptr;return this.ptr=0,e}free(){const e=this.__destroy_into_raw();o.__wbg_move_free(e)}get start_square(){return o.__wbg_get_move_start_square(this.ptr)}set start_square(e){o.__wbg_set_move_start_square(this.ptr,e)}get end_square(){return o.__wbg_get_move_end_square(this.ptr)}set end_square(e){o.__wbg_set_move_end_square(this.ptr,e)}get captured_piece(){const e=o.__wbg_get_move_captured_piece(this.ptr);return e===0?void 0:p.__wrap(e)}set captured_piece(e){let n=0;M(e)||(j(e,p),n=e.__destroy_into_raw()),o.__wbg_set_move_captured_piece(this.ptr,n)}get moved_piece(){const e=o.__wbg_get_move_moved_piece(this.ptr);return p.__wrap(e)}set moved_piece(e){j(e,p);var n=e.__destroy_into_raw();o.__wbg_set_move_moved_piece(this.ptr,n)}get moved_piece_after_move(){const e=o.__wbg_get_move_moved_piece_after_move(this.ptr);return p.__wrap(e)}set moved_piece_after_move(e){j(e,p);var n=e.__destroy_into_raw();o.__wbg_set_move_moved_piece_after_move(this.ptr,n)}static from_json(e){const n=x(e,o.__wbindgen_malloc,o.__wbindgen_realloc),r=E,s=o.move_from_json(n,r);return y.__wrap(s)}to_json(){try{const r=o.__wbindgen_add_to_stack_pointer(-16);o.move_to_json(r,this.ptr);var e=w()[r/4+0],n=w()[r/4+1];return O(e,n)}finally{o.__wbindgen_add_to_stack_pointer(16),o.__wbindgen_free(e,n)}}get_forced_moves_js(){const e=o.move_get_forced_moves_js(this.ptr);return $(e)}}class p{static __wrap(e){const n=Object.create(p.prototype);return n.ptr=e,n}__destroy_into_raw(){const e=this.ptr;return this.ptr=0,e}free(){const e=this.__destroy_into_raw();o.__wbg_piece_free(e)}get color(){return o.__wbg_get_piece_color(this.ptr)>>>0}set color(e){o.__wbg_set_piece_color(this.ptr,e)}get king(){return o.__wbg_get_piece_king(this.ptr)!==0}set king(e){o.__wbg_set_piece_king(this.ptr,e)}}async function me(t,e){if(typeof Response=="function"&&t instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(t,e)}catch(r){if(t.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",r);else throw r}const n=await t.arrayBuffer();return await WebAssembly.instantiate(n,e)}else{const n=await WebAssembly.instantiate(t,e);return n instanceof WebAssembly.Instance?{instance:n,module:t}:n}}function ye(){const t={};return t.wbg={},t.wbg.__wbg_piece_new=function(e){const n=p.__wrap(e);return u(n)},t.wbg.__wbindgen_object_drop_ref=function(e){$(e)},t.wbg.__wbg_move_new=function(e){const n=y.__wrap(e);return u(n)},t.wbg.__wbindgen_error_new=function(e,n){const r=new Error(O(e,n));return u(r)},t.wbg.__wbindgen_string_get=function(e,n){const r=c(n),s=typeof r=="string"?r:void 0;var _=M(s)?0:x(s,o.__wbindgen_malloc,o.__wbindgen_realloc),i=E;w()[e/4+1]=i,w()[e/4+0]=_},t.wbg.__wbindgen_is_string=function(e){return typeof c(e)=="string"},t.wbg.__wbg_new_abda76e883ba8a5f=function(){const e=new Error;return u(e)},t.wbg.__wbg_stack_658279fe44541cf6=function(e,n){const r=c(n).stack,s=x(r,o.__wbindgen_malloc,o.__wbindgen_realloc),_=E;w()[e/4+1]=_,w()[e/4+0]=s},t.wbg.__wbg_error_f851667af71bcfc6=function(e,n){try{console.error(O(e,n))}finally{o.__wbindgen_free(e,n)}},t.wbg.__wbindgen_is_object=function(e){const n=c(e);return typeof n=="object"&&n!==null},t.wbg.__wbindgen_jsval_loose_eq=function(e,n){return c(e)==c(n)},t.wbg.__wbindgen_boolean_get=function(e){const n=c(e);return typeof n=="boolean"?n?1:0:2},t.wbg.__wbindgen_number_get=function(e,n){const r=c(n),s=typeof r=="number"?r:void 0;de()[e/8+1]=M(s)?0:s,w()[e/4+0]=!M(s)},t.wbg.__wbg_get_27fe3dac1c4d0224=function(e,n){const r=c(e)[n>>>0];return u(r)},t.wbg.__wbg_length_e498fbc24f9c1d4f=function(e){return c(e).length},t.wbg.__wbg_new_b525de17f44a8943=function(){const e=new Array;return u(e)},t.wbg.__wbindgen_is_function=function(e){return typeof c(e)=="function"},t.wbg.__wbg_next_b7d530c04fd8b217=function(e){const n=c(e).next;return u(n)},t.wbg.__wbg_next_88560ec06a094dea=function(){return V(function(e){const n=c(e).next();return u(n)},arguments)},t.wbg.__wbg_done_1ebec03bbd919843=function(e){return c(e).done},t.wbg.__wbg_value_6ac8da5cc5b3efda=function(e){const n=c(e).value;return u(n)},t.wbg.__wbg_iterator_55f114446221aa5a=function(){return u(Symbol.iterator)},t.wbg.__wbg_get_baf4855f9a986186=function(){return V(function(e,n){const r=Reflect.get(c(e),c(n));return u(r)},arguments)},t.wbg.__wbg_call_95d1ea488d03e4e8=function(){return V(function(e,n){const r=c(e).call(c(n));return u(r)},arguments)},t.wbg.__wbg_isArray_39d28997bf6b96b4=function(e){return Array.isArray(c(e))},t.wbg.__wbg_push_49c286f04dd3bf59=function(e,n){return c(e).push(c(n))},t.wbg.__wbg_instanceof_ArrayBuffer_a69f02ee4c4f5065=function(e){let n;try{n=c(e)instanceof ArrayBuffer}catch{n=!1}return n},t.wbg.__wbg_entries_4e1315b774245952=function(e){const n=Object.entries(c(e));return u(n)},t.wbg.__wbg_buffer_cf65c07de34b9a08=function(e){const n=c(e).buffer;return u(n)},t.wbg.__wbg_new_537b7341ce90bb31=function(e){const n=new Uint8Array(c(e));return u(n)},t.wbg.__wbg_set_17499e8aa4003ebd=function(e,n,r){c(e).set(c(n),r>>>0)},t.wbg.__wbg_length_27a2afe8ab42b09f=function(e){return c(e).length},t.wbg.__wbg_instanceof_Uint8Array_01cebe79ca606cca=function(e){let n;try{n=c(e)instanceof Uint8Array}catch{n=!1}return n},t.wbg.__wbindgen_debug_string=function(e,n){const r=D(c(n)),s=x(r,o.__wbindgen_malloc,o.__wbindgen_realloc),_=E;w()[e/4+1]=_,w()[e/4+0]=s},t.wbg.__wbindgen_throw=function(e,n){throw new Error(O(e,n))},t.wbg.__wbindgen_memory=function(){const e=o.memory;return u(e)},t}function he(t,e){return o=t.exports,ee.__wbindgen_wasm_module=e,L=null,R=null,S=null,o.__wbindgen_start(),o}async function ee(t){typeof t>"u"&&(t=new URL(""+new URL("wasm_checkers_bg-8fe365dc.wasm",document.currentScript&&document.currentScript.src||document.baseURI).href,self.location));const e=ye();(typeof t=="string"||typeof Request=="function"&&t instanceof Request||typeof URL=="function"&&t instanceof URL)&&(t=fetch(t));const{instance:n,module:r}=await me(await t,e);return he(n,r)}var Ee=Object.freeze({__proto__:null,getBestMove:async(t,e,n,r)=>{const s=A.from_json(t),_=pe.get_best_move_alphabeta(s,e,r.computerDepth,r.checkersSettings,n?y.from_json(n):void 0);return _?_.to_json():null},initWasm:async()=>{await ee("wasm_checkers_bg-8fe365dc.wasm")}});q(Ee)})();
